
{% extends "base.html" %}
{% block title %}Home{% endblock %}

{% block content %}


<!-- Optional: Bootstrap Icons (add once in base.html <head> if you prefer) -->


<!-- HERO -->
<section class="hero-gradient py-5">
  <div class="container">
    <div class="row align-items-center g-5">
      <div class="col-lg-7">
        <h1 class="display-5 fw-bold lh-tight mb-3">
          Welcome{% if current_user.is_authenticated %}, {{ (current_user.email or 'Back')|title }}{% endif %}
        </h1>
        <p class="lead mb-4">
          This is a clean, polished Flask application suitable for desktop packaging and internal tools.
          Manage employees, track training submissions, and move fast—securely.
        </p>

        <div class="d-flex gap-2">
          <a href="{{ url_for('employees') }}" class="btn btn-light btn-lg px-4">
            <i class="bi bi-people me-2"></i>Employees
          </a>
          <a href="{{ url_for('table') }}" class="btn btn-outline-light btn-lg px-4">
            <i class="bi bi-table me-2"></i>Data Table
          </a>
        </div>
      </div>

      <div class="col-lg-5">
        <!-- Quick Add Form -->
        <div class="bg-white text-dark p-4 shadow-soft">
          <h2 class="h4 fw-semibold mb-3">Quick Add</h2>
          <p class="text-muted mb-4">Create a new user submission in seconds.</p>

          <form method="post" novalidate>
            <!-- CSRF (required because CSRFProtect is enabled) -->
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

            <div class="mb-3">
              <label class="form-label">Your Name</label>
              <input type="text"
                     name="name"
                     class="form-control"
                     placeholder="e.g., Mark Costantino"
                     required>
            </div>

            <div class="mb-3">
              <label class="form-label">Your Role</label>
              <input type="text"
                     name="role"
                     class="form-control"
                     placeholder="Analyst, Instructor, Developer">
            </div>

            <div class="d-grid">
              <button type="submit" class="btn btn-primary btn-lg">
                <i class="bi bi-plus-circle me-2"></i>Submit
              </button>
            </div>
          </form>

          {% if not current_user.is_authenticated %}
          <p class="mt-3 mb-0 small text-muted">
            Already have an account?
            <a class="link-primary" href="{{ url_for('login') }}">Sign in</a>.
            &nbsp;New here?
            <a class="link-primary" href="{{ url_for('register', next=request.args.get('next')) }}">Create an account</a>.
          </p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</section>

<!-- METRICS / INSIGHTS -->
<section class="py-4 section-muted">
  <div class="container">
    <div class="row g-3 text-center">
      <div class="col-6 col-lg-3">
        <div class="p-3 bg-white shadow-soft">
          <div class="text-primary fw-bold fs-4">{{ metrics.total_users or 0 }}</div>
          <div class="small text-muted">Total Submissions</div>
        </div>
      </div>
      <div class="col-6 col-lg-3">
        <div class="p-3 bg-white shadow-soft">
          <div class="text-primary fw-bold fs-4">{{ metrics.this_month or 0 }}</div>
          <div class="small text-muted">This Month</div>
        </div>
      </div>
      <div class="col-6 col-lg-3">
        <div class="p-3 bg-white shadow-soft">
          <div class="text-primary fw-bold fs-4">{{ metrics.unique_roles or 0 }}</div>
          <div class="small text-muted">Unique Roles</div>
        </div>
      </div>
      <div class="col-6 col-lg-3">
        <div class="p-3 bg-white shadow-soft">
          <div class="text-primary fw-bold fs-4">{{ metrics.last_7_days or 0 }}</div>
          <div class="small text-muted">Last 7 Days</div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- FEATURES -->
<section class="py-5">
  <div class="container">
    <div class="text-center mb-4">
      <h2 class="fw-bold lh-tight">Built for Speed & Reliability</h2>
      <p class="text-muted mb-0">Secure forms, fast tables, clean UI—ready for your team.</p>
    </div>

    <div class="row g-4">
      <div class="col-md-6 col-lg-3">
        <div class="h-100 p-4 bg-white shadow-soft">
          <div class="text-primary fs-3 mb-2"><i class="bi bi-shield-lock"></i></div>
          <h3 class="h6 fw-semibold">CSRF Protection</h3>
          <p class="text-muted mb-0">Every POST is protected using Flask‑WTF/CSRFProtect out‑of‑the‑box.</p>
        </div>
      </div>

      <div class="col-md-6 col-lg-3">
        <div class="h-100 p-4 bg-white shadow-soft">
          <div class="text-primary fs-3 mb-2"><i class="bi bi-people"></i></div>
          <h3 class="h6 fw-semibold">Employee Management</h3>
          <p class="text-muted mb-0">View, edit, and save employees with a smooth grid experience.</p>
        </div>
      </div>

      <div class="col-md-6 col-lg-3">
        <div class="h-100 p-4 bg-white shadow-soft">
          <div class="text-primary fs-3 mb-2"><i class="bi bi-clipboard2-check"></i></div>
          <h3 class="h6 fw-semibold">Training Tracking</h3>
          <p class="text-muted mb-0">Capture training completions and status with simple inputs.</p>
        </div>
      </div>

      <div class="col-md-6 col-lg-3">
        <div class="h-100 p-4 bg-white shadow-soft">
          <div class="text-primary fs-3 mb-2"><i class="bi bi-speedometer2"></i></div>
          <h3 class="h6 fw-semibold">Fast & Responsive</h3>
          <p class="text-muted mb-0">Bootstrap 5 base with clean semantics and accessible patterns.</p>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- GRAPH SECTION -->
<section class="py-5">
  <div class="container">

    <div class="text-center mb-4">
      <h2 class="fw-bold lh-tight">Analytics Overview</h2>
      <p class="text-muted mb-0">Visual insights into your latest submissions</p>
    </div>

    <div class="row g-4">

      <!-- Bar Chart -->
      <div class="col-lg-4">
        <div class="p-4 bg-white shadow-soft">
          <h5 class="fw-semibold text-center mb-3">Submissions by Month</h5>
          <canvas id="monthChart" height="180"></canvas>
        </div>
      </div>

      <!-- Doughnut Chart -->
      <div class="col-lg-4">
        <div class="p-4 bg-white shadow-soft">
          <h5 class="fw-semibold text-center mb-3">Roles Distribution</h5>
          <canvas id="roleChart" height="180"></canvas>
        </div>
      </div>

          <!-- Line Chart -->
      <div class="col-lg-4">
        <div class="p-4 bg-white shadow-soft">
          <h5 class="fw-semibold text-center mb-3">Last 7 Days</h5>
          <canvas id="dailyChart" height="180"></canvas>
        </div>
      </div>

    </div>

  </div>
</section>


<!-- RECENT SUBMISSIONS (optional) -->
<section class="py-5 section-muted">
  <div class="container">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2 class="h4 fw-semibold mb-0">Recent Submissions</h2>
      <a href="{{ url_for('employees') }}" class="btn btn-outline-primary btn-sm">
        <i class="bi bi-arrow-right-circle me-1"></i>View All
      </a>
    </div>

    <div class="table-responsive bg-white shadow-soft">
      <table class="table align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th class="text-nowrap">ID</th>
            <th class="text-nowrap">Name</th>
            <th class="text-nowrap">Role</th>
            <th class="text-nowrap">Created</th>
          </tr>
        </thead>
        <tbody>
          {% if recent and recent|length %}
            {% for r in recent %}
            <tr>
              <td class="text-muted">{{ r.id }}</td>
              <td class="fw-semibold">{{ r.name }}</td>
              <td>{{ r.role or '—' }}</td>
              <td class="text-muted">{{ r.created_at.strftime('%b %d, %Y %I:%M %p') if r.created_at else '—' }}</td>
            </tr>
            {% endfor %}
          {% else %}
            <tr>
              <td colspan="4" class="text-center text-muted py-4">No submissions yet.</td>
            </tr>
          {% endif %}
        </tbody>
      </table>
    </div>
  </div>
</section>

{% endblock %}


{% block scripts %}
    {{ super() }}  <!-- keeps Bootstrap + Handsontable from base.html -->
 <!-- <script src="{{ url_for('static', filename='js/handsontable.js') }}"></script> -->
 
<!-- Chart data injected by Flask template -->
<script>
  window.chartData = {
    months: {{ months|tojson }},
    monthVals: {{ counts|tojson }},
    dailyLabels: {{ daily_labels|tojson }},
    dailyVals: {{ daily_counts|tojson }},
    roleLabels: {{ role_labels|tojson }},
    roleVals: {{ role_counts|tojson }}
  };
</script>
<script src="{{ url_for('static', filename='js/chart.umd.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/app.js') }}"></script>

{% endblock %}



